spring.application.name=investsage

# ----------------------------------------
# SPRING AI OPENAI CONFIGURATION (v1.0.0-M6)
# ----------------------------------------
spring.ai.openai.api-key=${SPRING_AI_OPENAI_API_KEY:abc}

# Optional: Configure default model and options
spring.ai.openai.chat.options.model=gpt-4.1-nano-2025-04-14
spring.ai.openai.chat.options.temperature=0.7

# Optional: Logging level
logging.level.org.springframework.ai=${LOG_LEVEL_AI:INFO}
logging.level.com.dharmil.investsage.service=${LOG_LEVEL_SERVICE:INFO}
logging.level.root=INFO

# Server port (Railway sets PORT automatically)
server.port=${PORT:8080}

# Database configuration - Render external connection URL
# Render provides: postgresql://user:password@host:port/database
# We'll parse this via environment variable or use JDBC format directly
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5434/investsage_db_new?sslmode=disable}
spring.datasource.username=${DB_USERNAME:investsage_user_new}
spring.datasource.password=${DB_PASSWORD:yoursecurepassword}
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection pool settings for external database
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-test-query=SELECT 1

# --- OpenAI Embedding Model Configuration ---
spring.ai.openai.embedding.options.model=text-embedding-3-small

# Spring Batch JDBC Configuration
# Since tables already exist, set to 'never'
spring.batch.jdbc.initialize-schema=${BATCH_INITIALIZE_SCHEMA:always}
spring.batch.jdbc.platform=postgresql
spring.sql.init.mode=always
spring.sql.init.platform=postgresql

spring.batch.job.enabled=false

# 1. Data Import Job (CSV -> raw_investment_data)
app.batch.run-data-import=${RUN_DATA_IMPORT_JOB:false}

app.batch.run-embedding-job=${RUN_BATCH_EMBEDDING_JOB:true}
